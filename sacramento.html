<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no">

  <title>CCEP | Vote Center Siting Tool</title>
  
  <link rel="stylesheet"
        href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
        integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
        crossorigin=""/>
  <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/leaflet-search.css" />

  <link rel="stylesheet" href="css/style.css" />
</head>

<body>

<!-- Pop up modal -->
<div class="modal fade"
     id="myModal"
     tabindex="-1"
     role="dialog"
     aria-labelledby="myModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button"
                class="close"
                data-dismiss="modal"
                aria-hidden="true">&times;</button>

        <h2 class="modal-title" id="myModalLabel">How To Use This Tool (TODO)</h2>
      </div>

      <div id="how-to" class="modal-body">
        <div class="row">
          <div class="col-lg-12">
            <div class="one" style="position:relative;">
              <h3>Click menu, select data layer</h3>
            </div>
          </div>
          <div class="col-lg-12">
            <div class="two" style="position:relative;">
              <h3>Select Potential Vote Sites</h3>
            </div>
          </div>
          <div class="col-lg-12">
            <div class="three" style="position:relative;">
              <h3>Click Indicator Data to View Chropleth Maps</h3>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Pop up modal (#2) -->
<div class="modal fade"
     id="downloadModal"
     tabindex="-1"
     role="dialog"
     aria-labelledby="downloadModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button"
                class="close"
                data-dismiss="modal"
                aria-hidden="true">&times;</button>

        <h3 class="modal-title" id="downloadModalLabel">
          Data Description and Download Options
        </h3>
      </div>

      <div class="modal-body">
        <!-- Just add one of these for every dataset made available -->
         <h4>Data Descriptions</h4>
        <h5>Suggested Vote Center Data</h5>
        <p style="margin-left: 36px">
          Sites are colored based on their relative rank out of all potential sites as determined using  <a href="https://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization"> natural breaks</a>. The individual components of the composite score are displayed in the legend as being either <b>High</b>, <b>Med</b> or <b>Low</b>. The <b>High/Med/Low</b> are based on the distribution of scores for each component and ranked using natural breaks.
        </p>
        <ol> 
          <li>
            <b>Suggested Sites</b>: Sites that have been identified as being strategically located to voters and fulfilling requirements of SB450. This reflectes the minimum number of sites required. 
          </li>
          <li>
            <b>Additional Suggested Sites</b>:  These are those sites that are suggested if additinal sites over ther required minimum are desired. These sites assume the existence of the other <b>Suggested Sites</b>. 
          </li>
          <li>
            <b>All Suitable Sites</b>:  These are all sites that had a minimum of population, built environment etc where a vote site could potentially be located. This site can be used to identfy nearby sites with similary scores if the suggested site does not contain an actual reasonable voting location. 
          </li>
        </ol>

        <h5>Points of Interest</h5>
        <p style="margin-left: 36px">
        Points of Interest (POI) are sourced from <a href="https://www.openstreetmap.org/">OpenStreetMap</a>. The POIs are intended to help identify potential voting sites, or highlight that an area has some concentration of activity. 
        </p>
        <ol>
                  <li><b>Non-Government POIs</b>: These include schools, hospitals, kindergartens, community centers, arts centers, colleges, universities, malls, nursing homes, supermarkets, hostels and motels.
                  </li>
                  <li>
                  <b>Government POIs</b>: THese include post offices, fire stations, libraries, town halls, public buildings, police stations and courthouses. 
                </li>

        </ol>
  

        <h5>Indicator Data</h5>

        <ol class="fullDataDescriptionModalList">
          <!-- This is populated in interface.js' populateNavBarIndicators() -->
          <li>
            <b>Transit Stops</b>: Transit: Transit points indicate the location of transit stops in the county and are sourced from regional GTFS (iâ€™ll insert link) data feeds.  Transit stops have been ranked from low to high use based on the frequency of service to the individual stop.
          </li>
        </ol>

        <br>
        <h4>Data Downloads</h4>
        <h5>Vote Center Data</h5>
          <ol>
          <li> <a href="data/point_files/three_day_sites.csv">Suggested Areas for 4 Day Vote Centers</a></li>
          <li> <a href="data/point_files/ten_day_sites.csv">Suggested Areas for 10 Day Vote Centers</a></li>
          <li> <a href="data/point_files/dropbox_sites.csv">Suggested Areas for Ballot Drop Boxes </a></li>
          <li> <a href="data/point_files/additional_sites_model.csv">Addtl. Suggested Areas for Vote Centers (Model) </a></li>
          <li> <a href="data/point_files/additional_sites_distance.csv">Addtl. Suggested Areas for Vote Centers (Distance) </a></li>
          <li> <a href="data/point_files/all_sites.csv">All Potential Areas </a></li>

        </ol>
        <h5>Indicator Data</h5>
        <ol class="fullDownloadModalList">
          <!-- This is populated in interface.js' populateNavBarIndicators() -->
          <li><b>Indicator Data </b>
              <a href="data/indicator_files/indicator_data.csv">csv</a> | 
              <a href="data/indicator_files/indicator_data.zip">shp</a>
            </li>
          <li><a href="data/point_files/transit_stops.csv">Transit Stops</a></li>
          <li><a href="data/point_files/poi.csv">Points of Interest (All)</a></li>
          <li><a href="data/point_files/poi_misc.csv">Points of Interest (Non-Government)</a></li>
          <li><a href="data/point_files/poi._govish.csv">Points of Interest (Government)</a></li>

        </ol>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div class="navbar navbar-default">
  <div class="col-lg-12 col-sm-12 test">
    
    <a class="navbar-brand" href="http://ccep.ucdavis.edu/">
      <img src="assets/ccep_logo.png" alt="California Civic Engagement Project (CCEP)">
    </a>

        <button class="btn btn-primary pull-right hidden-xs"
            onclick=" window.open('index.html','_self');">
      <span class="glyphicon glyphicon-home "></span>
    </button>

    <button class="btn btn-primary pull-right hidden-xs"
            onclick="printScreen()">
      <span class="glyphicon glyphicon-print"></span>
    </button>

    <button class="btn btn-danger pull-right hidden-xs"
            data-toggle="modal"
            data-target="#myModal">
      How To Use This Tool
    </button>

    <h1>Vote Center Siting Tool</h1>

    <p class="intro">
    The Vote Center Siting Tool is designed to help county election officials identify optimal sites for potential Vote Center and Vote-by-Mail drop boxes. The tool uses a facility allocation model that incorporates the siting criteria included in the California Voter's Choice Act. The resulting interactive web maps are intended to supplement what election officials and stakeholders already know about their counties' profiles and needs.
    </p>

  </div>
</div>

<div class="posrel" style="width: 100%; overflow-x: hidden;">
  <div id="nav-panel" class="posabs">
    
    <ul class="nav nav-pills nav-stacked layer-toggle-menu">
      <li>
        <button type="button"
                class="btn btn-info btn-sm sharp-edges"
                data-toggle="modal"
                data-target="#downloadModal"
                style="width:100%">
          <span class="glyphicon glyphicon-download"></span> 
          Data Descriptions and Download
        </button>
      </li>
    </ul>
    
    <ul class="nav nav-pills nav-stacked layer-toggle-menu">
      <li>
        <button type="button"
                class="btn btn-danger btn-sm sharp-edges"
                onclick="clearLayerManager()"
                style="width:100%">
          <span class="glyphicon glyphicon-trash"></span> 
          Clear selection
        </button>
      </li>
    </ul>
    
    <h4 class="">Suggested Vote Center Areas</h4>

    <ul class="nav nav-pills nav-stacked models-menu points-menu ">
            <li id='three_day_sites'>
        <a onclick="populateMapWithPoints('three_day_sites.csv')">Suggested Areas for 4 Day Vote Centers</a>
      </li>
    <li id='ten_day_sites'>
        <a onclick="populateMapWithPoints('ten_day_sites.csv')">Suggested Areas for 11 Day Vote Centers</a>
      </li>
      <li id='dropbox_sites'>
        <a onclick="populateMapWithPoints('dropbox_sites.csv')">Suggested Areas for Ballot Drop Boxes </a>
      </li>
      <li id='all_sites'>
        <a onclick="populateMapWithPoints('all_sites.csv')">All Potential Areas</a>
      </li>
      <li id='additional_sites_model'>
        <a onclick="populateMapWithPoints('additional_sites_model.csv')">Addtl. Suggested Areas for Vote Centers (Model)</a>
      </li>
      <li id='additional_sites_distance'>
        <a onclick="populateMapWithPoints('additional_sites_distance.csv')">Addtl. Suggested Areas for Vote Centers (Distance)</a>
      </li>

    </ul>

<div style='padding: 10px'></div>
<h4> Additional Data</h4>
<div id="accordion">
  
  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <div class="nav nav-pills nav-stacked collapsed h5 extradata" data-toggle="collapse" data-target="#collapsePOIS" aria-expanded="false" aria-controls="collapsePOIS" onclick="downArrow('poi_arrow')">
          <i id="poi_arrow" class="arrow"></i> Points of interest
        </div>
      </h5>
    </div>
    <div id="collapsePOIS" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
    <ul class="nav nav-pills nav-stacked poi-menu points-menu">
      <li id='poi'>
        <a onclick="populateMapWithPoints('poi.csv')">Points of Interest (All) </a>
      </li>
        <li id='poi_govish'>
        <a onclick="populateMapWithPoints('poi_govish.csv')">Points of Interest (Government) </a>
      </li>
        <li id='poi_misc'>
        <a onclick="populateMapWithPoints('poi_misc.csv')">Points of Interest (Non-Government) </a>
      </li>
    </ul>
    </div>
  </div>
  
  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <div class="nav nav-pills nav-stacked h5 collapsed extradata" data-toggle="collapse" data-target="#collapseIndicator" aria-expanded="false" aria-controls="collapseIndicator" onclick="downArrow('indicator_arrow')" >
         <i id="indicator_arrow" class="arrow"></i>   Individual Data Layers
        </div>
      </h5>
    </div>
    <div id="collapseIndicator" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
    <ul class="nav nav-pills nav-stacked layer-toggle-menu indicator-menu points-menu">
            <li id='transit_stops'>
        <a onclick="populateMapWithPoints('transit_stops.csv')">Transit Stops</a>
      </li>
      <!-- These get added via the indicator_menu_fields.csv -->
    </ul>
    </div>
  </div>

</div>


</div>

  <div id="main-container" class="posabs" style="position:relative;">
    
    <div class="menu-toggle posabs btn-danger">
      <strong class="closed">
        Show Menu
      </strong>
      <strong class="open">
        <span class="glyphicon glyphicon-chevron-left"></span> Hide menu
      </strong>
    </div>

    <div id="content-wrapper" class="col-lg-12 col-md-12 col-sm-12">

      <div id="leaflet_map"></div>

      <div id="source">
        <h3 id="sources" class="panel-title">
          Sources
        </h3>
        <a id="source-title"></a>
      </div>

    </div>

  </div>
</div>

<div class="footer">
  <center>
    <a href="methodology.html">
      More Information on the Purpose and Creation of the Siting Tool
    </a>

    |
            <a href="acknowledgments.html">
      Acknowledgments
    </a> |
        <a href="mailto:msromero@ucdavis.edu?Subject=Vote%20Center%20Siting%20Tool">
      Contact
    </a>
    | 
    
    <a href="accessibility.html"><img src="assets/accessibility.svg"/></a>


    
  </center>
</div>

<!-- Libraries needed -->
<script src="js/jquery.min.js"
        type="text/javascript"></script>
<script src="js/simple_statistics.js"
        type="text/javascript"></script>

<!-- Leaflet related -->
<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
        integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
        crossorigin=""></script>

<!-- Leaflet geocoding -->
<script src="https://maps.googleapis.com/maps/api/js?v=3&sensor=false&key=AIzaSyBhsCF_BS6oDPz0zI4bB5ameixlRAX_880"></script>
<script src="js/leaflet_search_md.js"
        type="text/javascript"></script>

<script type="text/javascript">
  function adjustSizing() {
    var wdh = $(window).height();
    var nbh = $('.navbar').height();
    var bottomBarH = 36
    $('#leaflet_map').height(wdh - nbh - bottomBarH);
  }

  // First call it once on page load
  adjustSizing();

  // Then bind it to be called every time the page window is changed in size
  $(window).resize(adjustSizing);
</script>

<!-- Global variables -->
<script type="text/javascript">
  var mainMap = L.map('leaflet_map', {zoomControl: false});
  var layerManager = { choropleth: null , unreliable: null};
  var pointsData = {}
  var pointClick = null;
  var currentZoom = mainMap.getZoom();
  var cleanFiles = {}
  var cleanFields = {}


  // Instantiate Google geocoder object
  var geocoder = new google.maps.Geocoder();

  var rdPrpl = {
    0:'#f1eef6',
    1:'#d7b5d8',
    2:'#df65b0',
    3:'#dd1c77',
    4:'#980043'
  }
  

  // Display Stuff
  function downArrow(e){
    $("#"+e).toggleClass('down')
      
      }


</script>

<!-- TODO: This data loading should happen async -->
<script src="data/tracts.js"></script>
<script src="data/tract_centroid3310.js"></script>

<!-- Initialization library -->
<script src="js/initializer.js" type="text/javascript"></script>
<script src="js/interface.js" type="text/javascript"></script>
<script src="js/mapUtils.js" type="text/javascript"></script>

<!-- Remaining carry-over libraries -->
<script src="js/queue.v1.min.js"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>

</body>
</html>
